name: Release
  on:
    push:
      tags: ['v*']

  jobs:
    publish:
      runs-on: ubuntu-latest
      environment: release  # Enhanced security
      permissions:
        id-token: write  # Required for OIDC
      steps:
        - uses: actions/checkout@v4
        - uses: dtolnay/rust-toolchain@stable
        - uses: rust-lang/crates-io-auth-action@v1
          id: auth
        - run: cargo publish
          env:
            CARGO_REGISTRY_TOKEN: ${{ steps.auth.outputs.token }}
